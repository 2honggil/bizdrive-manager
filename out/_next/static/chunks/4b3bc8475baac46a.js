(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33492,(e,r,a)=>{r.exports=e.r(36410)},77409,e=>{"use strict";var r=e.i(85437),a=e.i(17082),t=e.i(33492),i=e.i(88314);e.i(51718);var s=e.i(18357);e.i(36180);var l=e.i(98925);let u=(0,a.createContext)(void 0);function o({children:e}){let[o,n]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0),m=(0,t.useRouter)(),h=(0,t.usePathname)();(0,a.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(i.auth,async e=>{if(e)try{let r=(0,l.query)((0,l.collection)(i.db,"users"),(0,l.where)("email","==",e.email)),a=await (0,l.getDocs)(r);if(a.empty)if("hongilee@mangoslab.com"===e.email){let r={email:e.email,role:"superadmin",name:"이홍길",department:"망고슬래브",status:"active",joinedAt:new Date().toISOString()};await (0,l.setDoc)((0,l.doc)(i.db,"users",e.uid),r),n({email:e.email,role:"superadmin",name:"이홍길",uid:e.uid})}else n({email:e.email,role:"user",name:e.displayName||e.email?.split("@")[0]||"User",uid:e.uid});else{let r=a.docs[0].data();n({email:e.email,role:r.role||"user",name:r.name||e.displayName||"Unknown",uid:e.uid})}}catch(r){console.error("Error fetching user data:",r),n({email:e.email,role:"user",name:e.displayName||"User",uid:e.uid})}else n(null);c(!1)});return()=>e()},[]),(0,a.useEffect)(()=>{d||o||"/login"===h||m.push("/login"),!d&&o&&"/login"===h&&m.push("/")},[d,o,h,m]);let p=async(e,r)=>{try{let a=await (0,s.signInWithEmailAndPassword)(i.auth,e,r);return n({email:a.user.email,role:"user",name:a.user.displayName||"User",uid:a.user.uid}),{success:!0}}catch(l){console.error("Login failed:",l);let a=l.code,t=l.message;if(("auth/user-not-found"===a||"auth/invalid-credential"===a||"auth/wrong-password"===a)&&("hongilee@mangoslab.com"===e&&"8493jis55&"===r||"user@example.com"===e&&"password"===r))try{let a=await (0,s.createUserWithEmailAndPassword)(i.auth,e,r);return n({email:a.user.email,role:"user",name:a.user.displayName||"User",uid:a.user.uid}),{success:!0}}catch(e){return console.error("Auto-creation failed:",e),{success:!1,error:`Auto-create failed: ${e.code}`}}return{success:!1,error:`${a}: ${t}`}}},f=async()=>{try{await (0,s.signOut)(i.auth),n(null),m.push("/login")}catch(e){console.error("Logout failed:",e)}};return(0,r.jsx)(u.Provider,{value:{user:o,login:p,logout:f,isLoading:d},children:d?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#0a0a0a] text-white",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-400 animate-pulse",children:"시스템 초기화 중..."})]}):e})}function n(){let e=(0,a.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>o,"useAuth",()=>n])}]);