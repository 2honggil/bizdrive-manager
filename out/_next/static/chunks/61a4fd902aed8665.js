(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25876,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},33492,(e,r,t)=>{r.exports=e.r(36410)},77409,e=>{"use strict";var r=e.i(85437),t=e.i(17082),a=e.i(33492),i=e.i(88314);e.i(51718);var s=e.i(18357);e.i(36180);var o=e.i(98925);let n=(0,t.createContext)(void 0);function l({children:e}){let[l,u]=(0,t.useState)(null),[c,d]=(0,t.useState)(!0),m=(0,a.useRouter)(),h=(0,a.usePathname)();(0,t.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(i.auth,async e=>{if(e)try{let r=(0,o.query)((0,o.collection)(i.db,"users"),(0,o.where)("email","==",e.email)),t=await (0,o.getDocs)(r);if(t.empty)if("hongilee@mangoslab.com"===e.email){let r={email:e.email,role:"superadmin",name:"이홍길",department:"망고슬래브",status:"active",joinedAt:new Date().toISOString()};await (0,o.setDoc)((0,o.doc)(i.db,"users",e.uid),r),u({email:e.email,role:"superadmin",name:"이홍길",uid:e.uid})}else u({email:e.email,role:"user",name:e.displayName||e.email?.split("@")[0]||"User",uid:e.uid});else{let r=t.docs[0].data();u({email:e.email,role:r.role||"user",name:r.name||e.displayName||"Unknown",uid:e.uid})}}catch(r){console.error("Error fetching user data:",r),u({email:e.email,role:"user",name:e.displayName||"User",uid:e.uid})}else u(null);d(!1)});return()=>e()},[]),(0,t.useEffect)(()=>{c||l||"/login"===h||m.push("/login"),!c&&l&&"/login"===h&&m.push("/")},[c,l,h,m]);let f=async(e,r)=>{try{return await (0,s.signInWithEmailAndPassword)(i.auth,e,r),{success:!0}}catch(o){console.error("Login failed:",o);let t=o.code,a=o.message;if(("auth/user-not-found"===t||"auth/invalid-credential"===t||"auth/wrong-password"===t)&&("hongilee@mangoslab.com"===e&&"8493jis55&"===r||"user@example.com"===e&&"password"===r))try{return await (0,s.createUserWithEmailAndPassword)(i.auth,e,r),{success:!0}}catch(e){return console.error("Auto-creation failed:",e),{success:!1,error:`Auto-create failed: ${e.code}`}}return{success:!1,error:`${t}: ${a}`}}},p=async()=>{try{await (0,s.signOut)(i.auth),u(null),m.push("/login")}catch(e){console.error("Logout failed:",e)}};return(0,r.jsx)(n.Provider,{value:{user:l,login:f,logout:p,isLoading:c},children:c?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#0a0a0a] text-white",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-400 animate-pulse",children:"시스템 초기화 중..."})]}):e})}function u(){let e=(0,t.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>l,"useAuth",()=>u])}]);