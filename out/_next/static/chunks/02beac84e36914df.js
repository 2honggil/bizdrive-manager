(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,25876,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},33492,(e,r,t)=>{r.exports=e.r(36410)},77409,e=>{"use strict";var r=e.i(85437),t=e.i(17082),a=e.i(33492),i=e.i(88314);e.i(51718);var s=e.i(18357);e.i(36180);var u=e.i(98925);let l=(0,t.createContext)(void 0);function o({children:e}){let[o,n]=(0,t.useState)(null),[c,d]=(0,t.useState)(!0),m=(0,a.useRouter)(),h=(0,a.usePathname)();(0,t.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(i.auth,async e=>{if(e)try{let r=(0,u.query)((0,u.collection)(i.db,"users"),(0,u.where)("email","==",e.email)),t=await (0,u.getDocs)(r);if(t.empty)if("hongilee@mangoslab.com"===e.email){let r={email:e.email,role:"superadmin",name:"이홍길",department:"망고슬래브",status:"active",joinedAt:new Date().toISOString()};await (0,u.setDoc)((0,u.doc)(i.db,"users",e.uid),r),n({email:e.email,role:"superadmin",name:"이홍길",uid:e.uid})}else n({email:e.email,role:"user",name:e.displayName||e.email?.split("@")[0]||"User",uid:e.uid});else{let r=t.docs[0].data();n({email:e.email,role:r.role||"user",name:r.name||e.displayName||"Unknown",uid:e.uid})}}catch(r){console.error("Error fetching user data:",r),n({email:e.email,role:"user",name:e.displayName||"User",uid:e.uid})}else n(null);d(!1)});return()=>e()},[]),(0,t.useEffect)(()=>{c||o||"/login"===h||m.push("/login"),!c&&o&&"/login"===h&&m.push("/")},[c,o,h,m]);let p=async(e,r)=>{try{let t=await (0,s.signInWithEmailAndPassword)(i.auth,e,r);return n({email:t.user.email,role:"user",name:t.user.displayName||"User",uid:t.user.uid}),{success:!0}}catch(u){console.error("Login failed:",u);let t=u.code,a=u.message;if(("auth/user-not-found"===t||"auth/invalid-credential"===t||"auth/wrong-password"===t)&&("hongilee@mangoslab.com"===e&&"8493jis55&"===r||"user@example.com"===e&&"password"===r))try{let t=await (0,s.createUserWithEmailAndPassword)(i.auth,e,r);return n({email:t.user.email,role:"user",name:t.user.displayName||"User",uid:t.user.uid}),{success:!0}}catch(e){return console.error("Auto-creation failed:",e),{success:!1,error:`Auto-create failed: ${e.code}`}}return{success:!1,error:`${t}: ${a}`}}},f=async()=>{try{await (0,s.signOut)(i.auth),n(null),m.push("/login")}catch(e){console.error("Logout failed:",e)}};return(0,r.jsx)(l.Provider,{value:{user:o,login:p,logout:f,isLoading:c},children:c?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#0a0a0a] text-white",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-primary/30 border-t-primary rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-400 animate-pulse",children:"시스템 초기화 중..."})]}):e})}function n(){let e=(0,t.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>o,"useAuth",()=>n])}]);